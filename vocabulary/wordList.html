<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta
      name="description"
      content="Boost your GRE preparation with expert practice in Analytical Writing, Quant, and Verbal. Get the best GRE prep resources, vocab practice, and quant problem-solving techniques."
    />
    <meta
      name="keywords"
      content="GRE prep, GRE practice, GRE writing, analytical writing, GRE quant practice, vocab, vocab practice, GRE preparation, GRE verbal, GRE study tips, Gre books, Gre books material"
    />
    <meta name="jhamghat" content="Jhamghat" />
    <meta name="robots" content="index, follow" />
    <meta
      property="og:title"
      content="Best GRE Preparation - Writing, Quant & Verbal Practice"
    />
    <meta
      property="og:description"
      content="Ace your GRE with top-notch preparation strategies, analytical writing exercises, quant problem-solving, and vocab practice."
    />
    <meta property="og:image" content="https://greprep.netlify.app/logo.png" />
    <meta property="og:url" content="https://greprep.netlify.app/" />
    <meta name="twitter:card" content="summary_large_image" />
    <meta
      name="twitter:title"
      content="GRE Prep - Writing, Quant & Vocab Practice"
    />
    <meta
      name="twitter:description"
      content="Excel in your GRE with effective study techniques and practice questions in writing, quant, and vocab."
    />
    <meta
      name="twitter:image"
      content="https://pbs.twimg.com/profile_images/1441442129629249537/tapqgD9Z_400x400.jpg"
    />
    <link rel="shortcut icon" href="../fav-icon.png" type="image/x-icon" />
    <title>Gre Prep: Books</title>
    <style>
      body {
        padding: 20px;
        margin: 0;
        background-color: #f9f9f9;
      }

      .header {
        display: flex;
        align-items: center;
        justify-content: space-between;
        flex-wrap: wrap;
        gap: 2rem;
        margin-bottom: 20px;
      }

      .header-a {
        color: #ffffff;
        text-decoration: none;
        background-color: #28a745;
        border: 1px solid #28a745;
        border-radius: 0.2rem;
        padding: 0.3rem 0.5rem;
      }

      .header-a:hover {
        color: #54d171;
      }

      .title{
        display: flex;
        justify-content: space-between;
        text-align: center;
        flex-wrap: wrap;
      }

      .breadcrumb {
        display: flex;
        flex-wrap: wrap;
        align-items: center;
        gap: 0.5rem;
        font-size: 1rem;
        margin: 20px 0;
        padding: 10px 15px;
        /* background-color: #ffffff; */
        border-radius: 8px;
        /* box-shadow: 0 2px 4px rgba(0, 0, 0, 0.05); */
        color: #333;
      }

      .breadcrumb a {
        color: #28a745;
        text-decoration: none;
        font-weight: 500;
        transition: color 0.2s ease;
        font-size: 1.2rem;
      }

      .breadcrumb a:hover {
        /* text-decoration: underline; */
        color: #1c7c36;
      }

      .breadcrumb span.separator {
        color: #aaa;
        user-select: none;
      }

      .breadcrumb span:last-child {
        font-size: 1.2rem;
        color: #555;
      }
      h1 {
        color: #333;
      }
      .books {
        display: flex;
        justify-content: space-between;
        gap: 20px;
        margin-top: 20px;
        flex-wrap: wrap;
      }

      .book {
        width: 100%;
        border: 1px solid #ccc;
        border-radius: 8px;
        box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
        overflow: hidden;
        text-align: center;
        transition: transform 0.3s ease-in-out;
      }

      .book:hover {
        transform: scale(1.05);
        cursor: pointer;
      }
      .book > a {
        text-decoration: none;
      }

      .book-image {
        width: 100%;
        height: 300px;
        object-fit: cover;
      }

      .book-title {
        font-size: 1.2rem;
        padding: 10px;
        background-color: #28a745;
        color: white;
        margin: 0;
        font-weight: bold;
      }

      footer {
        display: flex;
        justify-content: center;
        padding-top: 1rem;
      }

      @media only screen and (min-width: 600px) and (max-width: 900px) {
        .book {
          width: 47% !important;
        }
      }

      @media only screen and (min-width: 900px) {
        .book {
          width: 30% !important;
        }
      }

      .blue {
        background-color: rgb(43, 117, 255) !important;
        border: 1px solid rgb(43, 135, 255) !important;
      }

      .blue:hover {
        color: rgb(159, 197, 255) !important;
      }

      .red {
        background-color: rgb(255, 43, 43) !important;
        border: 1px solid rgb(255, 43, 43) !important;
      }

      .red:hover {
        color: rgb(255, 159, 159) !important;
      }

      .watermark {
        position: absolute;
        top: 50%;
        left: 0;
        width: 100%;
        height: 100%;
        pointer-events: none;
        opacity: 0.15;
        display: flex;
        justify-content: center;
        align-items: center;
        font-size: 60px;
        color: #333333;
        transform: rotate(-45deg);
        font-weight: bold;
        text-transform: uppercase;
      }

      .button-group {
        display: flex;
        justify-content: center;
        gap: 1rem;
        margin-bottom: 20px;
      }

      .button-group button {
        padding: 0.5rem 1rem;
        font-size: 1rem;
        cursor: pointer;
        background-color: #28a745;
        color: white;
        border: none;
        border-radius: 4px;
      }

      .button-group button:hover {
        background-color: #1c7c36;
      }

      table {
        width: 100%;
        border-collapse: collapse;
        background-color: white;
      }

      th,
      td {
        border: 1px solid #ccc;
        padding: 10px;
        text-align: left;
        vertical-align: top;
      }

      th {
        background-color: #28a745;
        color: white;
      }

      footer {
        display: flex;
        justify-content: center;
        padding-top: 1rem;
      }
      .sense-word-positive {
        color: green;
        font-weight: bold;
      }
      .sense-word-negative {
        color: red;
        font-weight: bold;
      }
      .sense-word-neutral {
        color: orange;
        font-weight: bold;
      }
    </style>
  </head>
  <body>
    <header class="header">
      <nav class="breadcrumb">
        <a href="/index.html">Home</a>
        <span class="separator">â€º</span>
        <a href="/vocabulary/vocabulary.html">Vocabulary</a>
        <span class="separator">â€º</span>
        <span>Word List</span>
      </nav>
      <div>
        <a href="/vocabulary/material.html" class="header-a">Materials</a>
        <a href="/vocabulary/vocabquiz.html" class="red header-a">Practice</a>
      </div>
    </header>

    <section class="title">
      <h1>Epreptest GRE Word List</h1>
      <h1 class="watermark">www.epreptest.com</h1>

      <div class="button-group">
        <button onclick="downloadPDF()" class="blue">Download PDF</button>
        <button onclick="downloadExcel()" class="blue">Download Excel</button>
      </div>
    </section>

    <section id="word-list">
      <table id="vocabTable">
        <thead>
          <tr>
            <th>SN</th>
            <th>Word</th>
            <th>Trait</th>
            <th>Sense</th>
            <th>Example</th>
            <th>Synonyms</th>
            <th>Antonyms</th>
          </tr>
        </thead>
        <tbody></tbody>
      </table>
    </section>

    <footer>Copyright @ 2025, Jhamghat</footer>

    <!-- Libraries for PDF and Excel export -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf-autotable/3.5.29/jspdf.plugin.autotable.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>

    <script>
      // Load JSON and render table
      fetch("vocabulary.json")
        .then((response) => response.json())
        .then((data) => {
          const tbody = document.querySelector("#vocabTable tbody");

          data.vocabulary.forEach((item, index) => {
            // Format SENSE field with colored spans
            let senseText = item.sense
              .replace(
                /\bPositive\b/,
                '<span class="sense-word-positive">Positive</span>'
              )
              .replace(
                /\bNegative\b/,
                '<span class="sense-word-negative">Negative</span>'
              )
              .replace(
                /\bNeutral\b/,
                '<span class="sense-word-neutral">Neutral</span>'
              );

            // Format EXAMPLES with ðŸŽ¯
            const exampleList = item.example
              .split(/<br\s*\/?>/)
              .map((e) => `ðŸŽ¯ ${e.trim()}`)
              .join("<br/>");

            // Format SYNONYMS with âœ… and vertical layout
            const synonymsList = item.synonyms
              .split(",")
              .map((syn) => `âœ… ${syn.trim()}`)
              .join("<br/>");

            // Format ANTONYMS with âœ… and vertical layout
            const antonymsList = item.antonyms
              .split(",")
              .map((ant) => `âœ… ${ant.trim()}`)
              .join("<br/>");

            // Create row
            const row = document.createElement("tr");
            row.innerHTML = `
          <td>${index + 1}</td>
          <td>${item.word}</td>
          <td>${item.trait}</td>
          <td>${senseText}</td>
          <td>${exampleList}</td>
          <td>${synonymsList}</td>
          <td>${antonymsList}</td>
        `;
            tbody.appendChild(row);
          });
        });

      // Improved PDF download function with repeating headers and proper styling
      function downloadPDF() {
        const { jsPDF } = window.jspdf;
        const doc = new jsPDF({ orientation: "landscape" });

        // Add a title to the document
        doc.setFontSize(18);
        doc.setTextColor(40, 167, 69); // Green title to match website theme

        // Clone table for manipulation
        const table = document.getElementById("vocabTable").cloneNode(true);

        // Clean up emojis and HTML for PDF
        const rows = table.querySelectorAll("tr");
        rows.forEach((row) => {
          const cells = row.querySelectorAll("td, th");
          cells.forEach((cell) => {
            // Remove emojis and HTML tags but preserve line breaks
            let content = cell.innerHTML
              .replace(/ðŸŽ¯|âœ…/g, "") // Remove emojis
              .replace(/<span class="[^"]*">([^<]*)<\/span>/g, "$1") // Extract text from spans
              .replace(/<br\s*\/?>/gi, "\n") // Convert <br> to new lines
              .replace(/<[^>]*>/g, "") // Remove other HTML tags
              .trim();

            cell.innerHTML = content;
          });
        });

        // Create a clean table for PDF
        doc.autoTable({
          head: [
            [
              "SN",
              "Word",
              "Trait",
              "Sense",
              "Examples",
              "Synonyms",
              "Antonyms",
            ],
          ],
          body: Array.from(rows)
            .slice(1)
            .map((row) => {
              return Array.from(row.cells).map((cell) => cell.innerHTML);
            }),
          headStyles: {
            fillColor: [40, 167, 69], // Green header color
            textColor: [255, 255, 255], // White text in header
            fontSize: 12,
            fontStyle: "bold",
            halign: "center",
          },
          startY: 20,
          styles: {
            overflow: "linebreak",
            cellPadding: 3,
            fontSize: 10,
            textColor: [0, 0, 0], // Black text
            lineWidth: 0.1,
          },
          alternateRowStyles: {
            fillColor: [240, 240, 240], // Light gray for alternate rows
          },
          columnStyles: {
            0: { cellWidth: 10 }, // SN column
            1: { cellWidth: 35, fontStyle: "bold" }, // Word column (bold)
            2: { cellWidth: 40 }, // Trait column
            3: { cellWidth: 50 }, // Sense column
            4: { cellWidth: 60 }, // Example column
            5: { cellWidth: 40 }, // Synonyms column
            6: { cellWidth: 40 }, // Antonyms column
          },
          didDrawPage: function (data) {
            // Add header to each page
            doc.setFontSize(18);
            doc.setTextColor(40, 167, 69);
            doc.text(
              "Epreptest GRE Word List",
              doc.internal.pageSize.width / 2,
              10,
              { align: "center" }
            );

            // Add page number at the bottom
            const pageSize = doc.internal.pageSize;
            const pageHeight = pageSize.height
              ? pageSize.height
              : pageSize.getHeight();
            doc.setFontSize(8);
            doc.text(
              "Page " +
                doc.internal.getCurrentPageInfo().pageNumber +
                " of " +
                doc.internal.getNumberOfPages(),
              pageSize.width - 20,
              pageHeight - 10
            );
          },
          margin: { top: 30 }, // Extra margin for the header
        });

        // Add watermark
        const totalPages = doc.internal.getNumberOfPages();
        for (let i = 1; i <= totalPages; i++) {
          doc.setPage(i);
          doc.setFontSize(20);
          doc.setTextColor(203, 203, 203);
          doc.text(
            "www.epreptest.com",
            doc.internal.pageSize.width / 2,
            doc.internal.pageSize.height / 2,
            {
              align: "center",
              angle: 45,
            }
          );
        }

        doc.save("Epreptest-GREWordList.pdf");
      }

      // Improved Excel download function with proper cell formatting
      function downloadExcel() {
        const wb = XLSX.utils.book_new();
        wb.Props = {
          Title: "Epreptest GRE Word List",
          Author: "Jhamghat",
          CreatedDate: new Date(),
        };

        const data = [];
        const headers = [
          "SN",
          "Word",
          "Trait",
          "Sense",
          "Examples",
          "Synonyms",
          "Antonyms",
        ];
        data.push(headers);

        fetch("vocabulary.json")
          .then((response) => response.json())
          .then((jsonData) => {
            jsonData.vocabulary.forEach((item, index) => {
              const row = [];
              row.push(index + 1);
              row.push(item.word);
              row.push(item.trait);
              const sense = item.sense
                .replace(/<br\s*\/?>/gi, "-> ")
                .replace(/<[^>]*>/g, "");
              row.push(sense);

              const examples = item.example
                .split(/<br\s*\/?>/)
                .map((e) => e.trim());
              row.push(examples.join(", "));

              // Synonyms - split to create a clean list
              const synonyms = item.synonyms.split(",").map((s) => s.trim());
              row.push(synonyms.join(", "));

              // Antonyms - split to create a clean list
              const antonyms = item.antonyms.split(",").map((a) => a.trim());
              row.push(antonyms.join(", "));

              data.push(row);
            });

            // Create worksheet
            const ws = XLSX.utils.aoa_to_sheet(data);

            // Set column widths
            const colWidths = [
              { wch: 5 }, // SN
              { wch: 15 }, // Word
              { wch: 25 }, // Trait
              { wch: 30 }, // Sense
              { wch: 40 }, // Examples
              { wch: 25 }, // Synonyms
              { wch: 25 }, // Antonyms
            ];
            ws["!cols"] = colWidths;

            // Apply text wrapping for all cells
            for (let cell in ws) {
              if (cell[0] !== "!") {
                // Skip special keys
                if (!ws[cell].s) ws[cell].s = {};
                ws[cell].s.alignment = { wrapText: true, vertical: "top" };
              }
            }

            // Style header row
            const headerRange = XLSX.utils.decode_range(ws["!ref"]);
            for (let C = headerRange.s.c; C <= headerRange.e.c; ++C) {
              const cell = XLSX.utils.encode_cell({ r: 0, c: C });
              if (!ws[cell].s) ws[cell].s = {};
              ws[cell].s.fill = { fgColor: { rgb: "28A745" } }; // Green background
              ws[cell].s.font = { bold: true, color: { rgb: "FFFFFF" } }; // White, bold text
            }

            // Add worksheet to workbook
            XLSX.utils.book_append_sheet(wb, ws, "GRE Words");

            // Save file
            XLSX.writeFile(wb, "Epreptest_GRE_Word_List.xlsx");
          })
          .catch((error) => {
            console.error("Error processing vocabulary data:", error);
            alert(
              "An error occurred while creating the Excel file. Please try again."
            );
          });
      }
    </script>
  </body>
</html>
